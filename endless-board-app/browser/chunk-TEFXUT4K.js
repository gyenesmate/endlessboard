import{b as B,c as z}from"./chunk-VNDCGUNK.js";import"./chunk-JGCTVKLB.js";import{e as N}from"./chunk-JY2YBEA6.js";import{Ab as l,Bb as R,Fb as y,Ga as c,Gb as I,Gc as T,Hb as S,Ka as f,Qa as x,Ua as C,cc as D,db as s,dc as E,fa as p,fc as k,ga as _,gc as F,hb as a,ib as r,jb as v,kb as b,lb as O,mb as h,ob as P,pb as m,sb as w,zb as g}from"./chunk-H5PX2EZB.js";import{c as d}from"./chunk-576YX7J7.js";function V(o,e){if(o&1){let t=h();a(0,"div")(1,"p"),l(2),r(),a(3,"button",10),P("click",function(){let i=p(t).$implicit,u=m(3);return _(u.deleteRoute(i.id))}),l(4," Delete "),r(),a(5,"div",11)(6,"app-climbing-wall",12,2),P("wallLoaded",function(){let i=p(t).$implicit,u=g(7),M=m(3);return _(M.onClimbingWallLoaded(i,u))}),r()()()}if(o&2){let t=e.$implicit,n=m(3);c(2),R(t.title),c(4),s("wall",n.wallData)("routeID",t.id)}}function W(o,e){if(o&1&&(b(0),C(1,V,8,3,"div",9),O()),o&2){let t=m().ngIf,n=m();c(),s("ngForOf",t)("ngForTrackBy",n.trackById)}}function $(o,e){o&1&&(a(0,"div"),l(1,"No routes found."),r())}function j(o,e){if(o&1&&(b(0),C(1,W,2,2,"ng-container",8)(2,$,2,0,"ng-template",null,1,S),O()),o&2){let t=e.ngIf,n=g(3);c(),s("ngIf",t.length>0)("ngIfElse",n)}}var U=class o{constructor(e,t,n){this.userManagmentService=e;this.routeManagmentService=t;this.router=n;this.userEmail=localStorage.getItem("userEmail"),this.userName=localStorage.getItem("authToken"),this.holdStateDict=new Map([["start-hold",16711680],["hold",16776960],["end-hold",65280],["default-hold",9849600],["select-hold",255]])}userEmail;userName;routes$;wallData={width:50,height:60};holdStateDict;ngOnInit(){return d(this,null,function*(){if(this.userEmail=localStorage.getItem("userEmail"),this.userEmail){let e=yield this.userManagmentService.getUserDocIdByEmail(this.userEmail);e&&(this.routes$=this.routeManagmentService.getRoutesByUserDocIdObs(e))}})}trackById(e,t){return t.id}onClimbingWallLoaded(e,t){for(let n=0;n<e.holds.length;n++){t.setHoldRotation(e.holds[n].posID,e.holds[n].angle);let i=this.holdStateDict.get(e.holds[n].state);i!==void 0&&t.setHoldState(e.holds[n].posID,i)}}userNameChange(e){return d(this,null,function*(){this.userEmail!==null&&(yield this.userManagmentService.updateUserNameByEmail(this.userEmail,e).then(()=>{this.userEmail=e,localStorage.setItem("authToken",e),this.router.navigateByUrl("/main"),alert("UserName has been updated!")}))})}deleteRoute(e){return d(this,null,function*(){this.userEmail&&(yield this.routeManagmentService.deleteRouteByEmailAndRouteId(this.userEmail,e),alert("Route has been deleted!"))})}static \u0275fac=function(t){return new(t||o)(f(T),f(z),f(N))};static \u0275cmp=x({type:o,selectors:[["app-profile-page"]],decls:14,vars:5,consts:[["userNameInput",""],["noRoutes",""],["climbingWall",""],[1,"userData"],["type","text",3,"value"],[3,"click","disabled"],[1,"userRoutes"],[4,"ngIf"],[4,"ngIf","ngIfElse"],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"click"],[1,"climbing-wall-container",2,"width","100%","height","400px"],[3,"wallLoaded","wall","routeID"]],template:function(t,n){if(t&1){let i=h();a(0,"h1"),l(1,"Profile"),r(),a(2,"div",3)(3,"h4"),l(4,"User Name:"),r(),v(5,"input",4,0),a(7,"button",5),P("click",function(){p(i);let M=g(6);return _(n.userNameChange(M.value))}),l(8," Change "),r()(),a(9,"div",6)(10,"h4"),l(11,"Own Routes:"),r(),C(12,j,4,2,"ng-container",7),y(13,"async"),r()}if(t&2){let i=g(6);c(5),w("value",n.userName),c(2),s("disabled",i.value===n.userName),c(5),s("ngIf",I(13,3,n.routes$))}},dependencies:[B,F,D,E,k],styles:["h1[_ngcontent-%COMP%]{text-align:center;font-size:2rem;font-weight:600;margin:2.5rem 0 2rem;color:#2d384b;letter-spacing:.035em}.userData[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1.1rem;justify-content:center;margin-bottom:2.5rem}.userData[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 .6rem 0 0;font-size:1.13rem;color:#294686}.userData[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]{font-size:1.05rem;border-radius:8px;border:1.5px solid #c3cbe0;background:#f5f8fc;padding:.52em 1em;transition:border-color .16s;min-width:160px}.userData[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]:focus{border-color:#294686;background:#fff;outline:none}.userData[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:1rem;font-weight:600;border:1.7px solid #197749;color:#197749;border-radius:7px;background:#f5fcf7;padding:.49em 1.2em;cursor:pointer;transition:background .14s,color .14s;margin-left:.4rem}.userData[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:enabled, .userData[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:focus:enabled{background:#197749;color:#fff}.userData[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.6;background:#eef4f0;color:#7e8e82;cursor:not-allowed}.userRoutes[_ngcontent-%COMP%]{max-width:780px;margin:0 auto 3rem;padding:0 1.1rem}.userRoutes[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:#294686;margin-bottom:.8rem}.userRoutes[_ngcontent-%COMP%]   .noRoutes[_ngcontent-%COMP%]{text-align:center;color:#868899;opacity:.87;font-size:1.1rem;margin-top:1.5rem}.userRoutes[_ngcontent-%COMP%] > div[ngfor][_ngcontent-%COMP%], .userRoutes[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{background:#fff;border-radius:14px;box-shadow:0 8px 32px #3c485317,0 1.5px 6px #20232705;margin-bottom:2.2rem;padding:1.5rem 2.1rem;position:relative;display:flex;flex-direction:column;gap:.8rem}.userRoutes[_ngcontent-%COMP%] > div[ngfor][_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .userRoutes[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 .3rem;font-size:1.13rem;font-weight:500;color:#294686;word-break:break-word}.userRoutes[_ngcontent-%COMP%] > div[ngfor][_ngcontent-%COMP%]   button[_ngcontent-%COMP%], .userRoutes[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{align-self:flex-start;margin-bottom:.7rem;padding:.5em 1em;font-size:.98rem;font-weight:600;border-radius:6px;border:1.7px solid #be2411;color:#be2411;background:#fff4f3;cursor:pointer;transition:background .15s,color .14s}.userRoutes[_ngcontent-%COMP%] > div[ngfor][_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover, .userRoutes[_ngcontent-%COMP%] > div[ngfor][_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:focus, .userRoutes[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover, .userRoutes[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:focus{background:#be2411;color:#fff}.userRoutes[_ngcontent-%COMP%] > div[ngfor][_ngcontent-%COMP%]   .climbing-wall-container[_ngcontent-%COMP%], .userRoutes[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   .climbing-wall-container[_ngcontent-%COMP%]{margin-top:.7rem;border-radius:10px;overflow:hidden;background:#eff3fa;box-shadow:0 .5px 10px #2857c60a;width:100%;height:400px;display:flex;align-items:center;justify-content:center}@media (max-width: 780px){.userRoutes[_ngcontent-%COMP%]{max-width:100%;padding:0 .5rem}.userRoutes[_ngcontent-%COMP%] > div[_ngcontent-%COMP%], .userRoutes[_ngcontent-%COMP%] > div[ngfor][_ngcontent-%COMP%]{padding:1.2rem .7rem}}@media (max-width: 560px){h1[_ngcontent-%COMP%]{font-size:1.27rem;margin:1.2rem 0 .8rem}.userData[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch;gap:.8rem;margin-bottom:1.3rem}.userData[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 .35rem}.userData[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]{min-width:0;font-size:.98rem;padding:.39em .6em}.userData[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:.98rem;padding:.43em 1em;margin-left:0}}"]})};export{U as ProfilePageComponent};
